<!DOCTYPE html>

<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Gestor de Gastos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .header {
        text-align: center;
        margin-bottom: 40px;
    }

    .header h1 {
        color: white;
        font-size: 2.5rem;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .balance-card {
        background: white;
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .balance-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
    }

    .balance-item {
        text-align: center;
        padding: 20px;
        border-radius: 15px;
    }

    .balance-item.income {
        background: linear-gradient(135deg, #4CAF50, #45a049);
        color: white;
    }

    .balance-item.expense {
        background: linear-gradient(135deg, #f44336, #da190b);
        color: white;
    }

    .balance-item.investment {
        background: linear-gradient(135deg, #FF9800, #F57C00);
        color: white;
    }

    .balance-item.total {
        background: linear-gradient(135deg, #2196F3, #1976D2);
        color: white;
    }

    .balance-amount {
        font-size: 1.8rem;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .balance-label {
        font-size: 0.9rem;
        opacity: 0.9;
    }

    .charts-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        margin-bottom: 30px;
    }

    .chart-card {
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .chart-card h3 {
        text-align: center;
        margin-bottom: 20px;
        color: #333;
        font-size: 1.3rem;
    }

    .chart-container {
        position: relative;
        height: 300px;
        width: 100%;
    }

    .form-card {
        background: white;
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
    }

    .form-group {
        display: flex;
        flex-direction: column;
    }

    .form-group label {
        margin-bottom: 8px;
        font-weight: 600;
        color: #555;
    }

    .form-group input, .form-group select {
        padding: 12px;
        border: 2px solid #e1e5e9;
        border-radius: 10px;
        font-size: 1rem;
        transition: all 0.3s ease;
    }

    .form-group input:focus, .form-group select:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        width: 100%;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .transactions-section {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 30px;
    }

    .transactions-card {
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .transactions-card h2 {
        margin-bottom: 20px;
        color: #333;
        text-align: center;
    }

    .transactions-card.income h2 {
        color: #4CAF50;
    }

    .transactions-card.expense h2 {
        color: #f44336;
    }

    .transactions-card.investment h2 {
        color: #FF9800;
    }

    .transaction-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        border-bottom: 1px solid #f0f0f0;
        transition: background 0.3s ease;
    }

    .transaction-item:hover {
        background: #f8f9fa;
    }

    .transaction-item:last-child {
        border-bottom: none;
    }

    .transaction-info {
        flex-grow: 1;
    }

    .transaction-description {
        font-weight: 600;
        color: #333;
        margin-bottom: 5px;
    }

    .transaction-details {
        font-size: 0.9rem;
        color: #666;
    }

    .transaction-amount {
        font-weight: bold;
        font-size: 1.1rem;
    }

    .transaction-amount.income {
        color: #4CAF50;
    }

    .transaction-amount.expense {
        color: #f44336;
    }

    .transaction-amount.investment {
        color: #FF9800;
    }

    .delete-btn {
        background: #f44336;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
        margin-left: 10px;
        font-size: 0.8rem;
    }

    .delete-btn:hover {
        background: #da190b;
    }

    .empty-state {
        text-align: center;
        padding: 40px;
        color: #666;
    }

    .empty-state h3 {
        margin-bottom: 10px;
        color: #999;
    }

    @media (max-width: 768px) {
        .container {
            padding: 10px;
        }
        
        .header h1 {
            font-size: 2rem;
        }
        
        .form-grid {
            grid-template-columns: 1fr;
        }
        
        .balance-grid {
            grid-template-columns: 1fr;
        }

        .charts-container {
            grid-template-columns: 1fr;
        }

        .transactions-section {
            grid-template-columns: 1fr;
        }

        .chart-container {
            height: 250px;
        }
    }
</style>
```

</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üí∞ Mi Gestor de Gastos</h1>
        </header>

```
    <!-- Resumen de balance -->
    <div class="balance-card">
        <div class="balance-grid">
            <div class="balance-item income">
                <div class="balance-amount" id="totalIncome">‚Ç¨0.00</div>
                <div class="balance-label">Ingresos</div>
            </div>
            <div class="balance-item expense">
                <div class="balance-amount" id="totalExpense">‚Ç¨0.00</div>
                <div class="balance-label">Gastos</div>
            </div>
            <div class="balance-item investment">
                <div class="balance-amount" id="totalInvestment">‚Ç¨0.00</div>
                <div class="balance-label">Inversiones</div>
            </div>
            <div class="balance-item total">
                <div class="balance-amount" id="totalBalance">‚Ç¨0.00</div>
                <div class="balance-label">Balance Total</div>
            </div>
        </div>
    </div>

    <!-- Gr√°ficos -->
    <div class="charts-container">
        <div class="chart-card">
            <h3>üìä Resumen General</h3>
            <div class="chart-container">
                <canvas id="generalChart"></canvas>
            </div>
        </div>
        <div class="chart-card">
            <h3>üí∏ Gastos por Categor√≠a</h3>
            <div class="chart-container">
                <canvas id="expenseChart"></canvas>
            </div>
        </div>
        <div class="chart-card">
            <h3>üìà Inversiones por Categor√≠a</h3>
            <div class="chart-container">
                <canvas id="investmentChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Formulario -->
    <div class="form-card">
        <h2 style="margin-bottom: 20px; color: #333;">A√±adir Transacci√≥n</h2>
        <form id="transactionForm">
            <div class="form-grid">
                <div class="form-group">
                    <label for="type">Tipo</label>
                    <select id="type" required>
                        <option value="">Seleccionar tipo</option>
                        <option value="income">Ingreso</option>
                        <option value="expense">Gasto</option>
                        <option value="investment">Inversi√≥n</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="amount">Cantidad (‚Ç¨)</label>
                    <input type="number" id="amount" step="0.01" min="0" required>
                </div>
                <div class="form-group">
                    <label for="category">Categor√≠a</label>
                    <select id="category" required>
                        <option value="">Seleccionar categor√≠a</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="date">Fecha</label>
                    <input type="date" id="date" required>
                </div>
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label for="description">Descripci√≥n</label>
                <input type="text" id="description" placeholder="Ej: Compra en el supermercado" required>
            </div>
            <button type="submit" class="btn">A√±adir Transacci√≥n</button>
        </form>
    </div>

    <!-- Lista de transacciones separadas -->
    <div class="transactions-section">
        <div class="transactions-card income">
            <h2>üí∞ Ingresos</h2>
            <div id="incomeList">
                <div class="empty-state">
                    <h3>No hay ingresos todav√≠a</h3>
                    <p>A√±ade tus primeros ingresos</p>
                </div>
            </div>
        </div>

        <div class="transactions-card expense">
            <h2>üí∏ Gastos</h2>
            <div id="expenseList">
                <div class="empty-state">
                    <h3>No hay gastos todav√≠a</h3>
                    <p>A√±ade tus primeros gastos</p>
                </div>
            </div>
        </div>

        <div class="transactions-card investment">
            <h2>üìà Inversiones</h2>
            <div id="investmentList">
                <div class="empty-state">
                    <h3>No hay inversiones todav√≠a</h3>
                    <p>A√±ade tus primeras inversiones</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Variables globales
    let transactions = [];
    let charts = {};

    // Categor√≠as por tipo
    const categories = {
        income: [
            { value: 'nomina', label: 'N√≥mina' },
            { value: 'cta', label: 'CTA' }
        ],
        expense: [
            { value: 'alimentacion', label: 'Alimentaci√≥n' },
            { value: 'transporte', label: 'Transporte' },
            { value: 'entretenimiento', label: 'Entretenimiento' },
            { value: 'salud', label: 'Salud' },
            { value: 'educacion', label: 'Educaci√≥n' },
            { value: 'vivienda', label: 'Vivienda' },
            { value: 'ropa', label: 'Ropa' },
            { value: 'servicios', label: 'Servicios' },
            { value: 'otros', label: 'Otros' }
        ],
        investment: [
            { value: 'acciones', label: 'Acciones' },
            { value: 'criptomonedas', label: 'Criptomonedas' },
            { value: 'fondos', label: 'Fondos de Inversi√≥n' },
            { value: 'bonos', label: 'Bonos' },
            { value: 'inmobiliario', label: 'Inmobiliario' },
            { value: 'commodities', label: 'Commodities' },
            { value: 'otros_inv', label: 'Otras Inversiones' }
        ]
    };

    // Elementos DOM
    const form = document.getElementById('transactionForm');
    const typeSelect = document.getElementById('type');
    const categorySelect = document.getElementById('category');
    const dateInput = document.getElementById('date');

    // Elementos de balance
    const totalIncome = document.getElementById('totalIncome');
    const totalExpense = document.getElementById('totalExpense');
    const totalInvestment = document.getElementById('totalInvestment');
    const totalBalance = document.getElementById('totalBalance');

    // Listas de transacciones
    const incomeList = document.getElementById('incomeList');
    const expenseList = document.getElementById('expenseList');
    const investmentList = document.getElementById('investmentList');

    // Inicializar fecha actual
    const today = new Date();
    const todayString = today.getFullYear() + '-' + 
        String(today.getMonth() + 1).padStart(2, '0') + '-' + 
        String(today.getDate()).padStart(2, '0');
    dateInput.value = todayString;

    // Actualizar categor√≠as seg√∫n el tipo
    typeSelect.addEventListener('change', function() {
        const selectedType = this.value;
        categorySelect.innerHTML = '<option value="">Seleccionar categor√≠a</option>';
        
        if (selectedType && categories[selectedType]) {
            categories[selectedType].forEach(category => {
                const option = document.createElement('option');
                option.value = category.value;
                option.textContent = category.label;
                categorySelect.appendChild(option);
            });
        }
    });

    // Funci√≥n para formatear n√∫meros como moneda
    function formatCurrency(amount) {
        return new Intl.NumberFormat('es-ES', {
            style: 'currency',
            currency: 'EUR'
        }).format(amount);
    }

    // Funci√≥n para formatear fechas
    function formatDate(dateString) {
        const date = new Date(dateString + 'T00:00:00');
        return date.toLocaleDateString('es-ES', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric'
        });
    }

    // Funci√≥n para obtener el label de la categor√≠a
    function getCategoryLabel(type, value) {
        const typeCategories = categories[type];
        if (!typeCategories) return value;
        
        const category = typeCategories.find(cat => cat.value === value);
        return category ? category.label : value;
    }

    // Funci√≥n para calcular totales
    function calculateTotals() {
        const income = transactions
            .filter(t => t.type === 'income')
            .reduce((sum, t) => sum + t.amount, 0);

        const expense = transactions
            .filter(t => t.type === 'expense')
            .reduce((sum, t) => sum + t.amount, 0);

        const investment = transactions
            .filter(t => t.type === 'investment')
            .reduce((sum, t) => sum + t.amount, 0);

        const balance = income - expense - investment;

        totalIncome.textContent = formatCurrency(income);
        totalExpense.textContent = formatCurrency(expense);
        totalInvestment.textContent = formatCurrency(investment);
        totalBalance.textContent = formatCurrency(balance);
    }

    // Funci√≥n para crear gr√°ficos
    function createCharts() {
        // Destruir gr√°ficos existentes
        Object.values(charts).forEach(chart => chart.destroy());
        charts = {};

        // Gr√°fico general
        const generalCtx = document.getElementById('generalChart').getContext('2d');
        const income = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
        const expense = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
        const investment = transactions.filter(t => t.type === 'investment').reduce((sum, t) => sum + t.amount, 0);

        if (income > 0 || expense > 0 || investment > 0) {
            charts.general = new Chart(generalCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Ingresos', 'Gastos', 'Inversiones'],
                    datasets: [{
                        data: [income, expense, investment],
                        backgroundColor: ['#4CAF50', '#f44336', '#FF9800'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Gr√°fico de gastos por categor√≠a
        const expenseCtx = document.getElementById('expenseChart').getContext('2d');
        const expensesByCategory = {};
        transactions.filter(t => t.type === 'expense').forEach(t => {
            const label = getCategoryLabel('expense', t.category);
            expensesByCategory[label] = (expensesByCategory[label] || 0) + t.amount;
        });

        if (Object.keys(expensesByCategory).length > 0) {
            charts.expense = new Chart(expenseCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(expensesByCategory),
                    datasets: [{
                        data: Object.values(expensesByCategory),
                        backgroundColor: [
                            '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7',
                            '#DDA0DD', '#98D8C8', '#FFA07A', '#F0E68C', '#B0C4DE'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Gr√°fico de inversiones por categor√≠a
        const investmentCtx = document.getElementById('investmentChart').getContext('2d');
        const investmentsByCategory = {};
        transactions.filter(t => t.type === 'investment').forEach(t => {
            const label = getCategoryLabel('investment', t.category);
            investmentsByCategory[label] = (investmentsByCategory[label] || 0) + t.amount;
        });

        if (Object.keys(investmentsByCategory).length > 0) {
            charts.investment = new Chart(investmentCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(investmentsByCategory),
                    datasets: [{
                        data: Object.values(investmentsByCategory),
                        backgroundColor: [
                            '#FF9500', '#FF6B00', '#FF8C42', '#FFA726', '#FFB74D',
                            '#FFCC02', '#FFD54F', '#FFE082', '#FFECB3', '#FFF3E0'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
    }

    // Funci√≥n para eliminar transacci√≥n
    function deleteTransaction(id) {
        if (confirm('¬øEst√°s seguro de que quieres eliminar esta transacci√≥n?')) {
            transactions = transactions.filter(t => t.id !== id);
            renderTransactions();
            calculateTotals();
            createCharts();
        }
    }

    // Funci√≥n para renderizar transacciones por tipo
    function renderTransactionsByType(type, container) {
        const typeTransactions = transactions.filter(t => t.type === type);
        
        if (typeTransactions.length === 0) {
            const emptyMessages = {
                income: 'No hay ingresos todav√≠a',
                expense: 'No hay gastos todav√≠a',
                investment: 'No hay inversiones todav√≠a'
            };
            
            container.innerHTML = `
                <div class="empty-state">
                    <h3>${emptyMessages[type]}</h3>
                    <p>A√±ade tu primer ${type === 'income' ? 'ingreso' : type === 'expense' ? 'gasto' : 'inversi√≥n'}</p>
                </div>
            `;
            return;
        }

        const sortedTransactions = [...typeTransactions].sort((a, b) => new Date(b.date) - new Date(a.date));

        container.innerHTML = sortedTransactions.map((transaction) => `
            <div class="transaction-item">
                <div class="transaction-info">
                    <div class="transaction-description">${transaction.description}</div>
                    <div class="transaction-details">
                        ${getCategoryLabel(transaction.type, transaction.category)} ‚Ä¢ ${formatDate(transaction.date)}
                    </div>
                </div>
                <div style="display: flex; align-items: center;">
                    <div class="transaction-amount ${transaction.type}">
                        ${formatCurrency(transaction.amount)}
                    </div>
                    <button class="delete-btn" onclick="deleteTransaction(${transaction.id})">
                        üóëÔ∏è
                    </button>
                </div>
            </div>
        `).join('');
    }

    // Funci√≥n para renderizar todas las transacciones
    function renderTransactions() {
        renderTransactionsByType('income', incomeList);
        renderTransactionsByType('expense', expenseList);
        renderTransactionsByType('investment', investmentList);
    }

    // Funci√≥n para a√±adir transacci√≥n
    function addTransaction(transactionData) {
        const transaction = {
            id: Date.now(),
            type: transactionData.type,
            amount: parseFloat(transactionData.amount),
            category: transactionData.category,
            date: transactionData.date,
            description: transactionData.description
        };

        transactions.push(transaction);
        renderTransactions();
        calculateTotals();
        createCharts();
    }

    // Event listener para el formulario
    form.addEventListener('submit', (e) => {
        e.preventDefault();

        const type = document.getElementById('type').value;
        const amount = document.getElementById('amount').value;
        const category = document.getElementById('category').value;
        const date = document.getElementById('date').value;
        const description = document.getElementById('description').value;

        if (!type || !amount || !category || !date || !description) {
            alert('Por favor, completa todos los campos');
            return;
        }

        const transactionData = {
            type: type,
            amount: amount,
            category: category,
            date: date,
            description: description
        };

        addTransaction(transactionData);
        
        form.reset();
        const today = new Date();
        const todayString = today.getFullYear() + '-' + 
            String(today.getMonth() + 1).padStart(2, '0') + '-' + 
            String(today.getDate()).padStart(2, '0');
        dateInput.value = todayString;
        
        // Limpiar selector de categor√≠a
        categorySelect.innerHTML = '<option value="">Seleccionar categor√≠a</option>';
    });

    // Hacer deleteTransaction disponible globalmente
    window.deleteTransaction = deleteTransaction;

    // Inicializar cuando se carga la p√°gina
    document.addEventListener('DOMContentLoaded', function() {
        renderTransactions();
        calculateTotals();
        createCharts();
    });
</script>
```

</body>
</html>
